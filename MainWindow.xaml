<Window x:Class="DesktopTaskAid.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:DesktopTaskAid.ViewModels"
        Title="Desktop Task Aid" 
        Height="1140" Width="1440"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        WindowStyle="ThreeDBorderWindow"
        Background="{DynamicResource BgLight}"
        FontFamily="Segoe UI, Arial">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid>
        <!-- Main Content Area - 1188px width, centered -->
        <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,20,0,20">
            <StackPanel Width="1188" HorizontalAlignment="Center">
                
                <!-- Hero Grid: 356px left column + 67px gap + right column -->
                <Grid Margin="0,0,0,35">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="356"/>
                        <ColumnDefinition Width="67"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Left: Welcome Card -->
                    <StackPanel Grid.Column="0">
                        <!-- Welcome Text -->
                        <StackPanel Margin="0,0,0,23">
                            <TextBlock FontSize="36" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}" LineHeight="54" TextWrapping="Wrap">
                                Welcome back!
                            </TextBlock>
                            <TextBlock FontSize="16" Foreground="{DynamicResource TextSecondary}" LineHeight="24" 
                                       TextWrapping="Wrap" MaxWidth="309" Margin="0,5,0,0">
                                Organize your tasks, keep your mind clean and boost your <Run Text="productivity" TextDecorations="Underline" Foreground="{DynamicResource Accent}"/>!
                            </TextBlock>
                        </StackPanel>
                        
                        <!-- Welcome Illustration - 305x345px with 28px radius -->
                        <Border Width="305" Height="345" Background="{DynamicResource Surface}" 
                                BorderBrush="{DynamicResource Border}" BorderThickness="1" 
                                CornerRadius="28">
                            <Border.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="4" Opacity="0.08"/>
                            </Border.Effect>
                            <!-- Theme-aware illustration -->
                            <Image x:Name="WelcomeIllustration" 
                                   Source="assets/images/sticker-light.png" 
                                   Stretch="Uniform" 
                                   Margin="20"/>
                        </Border>
                    </StackPanel>
                    
                    <!-- Right: Upcoming Card + Calendar Card (stacked with 35px gap) -->
                    <StackPanel Grid.Column="2">
                        
                        <!-- Upcoming Card -->
                        <Border Background="{DynamicResource Surface}" BorderBrush="{DynamicResource Border}" 
                                BorderThickness="1" CornerRadius="16" Padding="16,16,30,16" Margin="0,0,0,35">
                            <Border.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="4" Opacity="0.08"/>
                            </Border.Effect>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Upcoming Info -->
                                <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding UpcomingTask.Name, FallbackValue='Upcoming task name'}" 
                                               FontSize="18" FontWeight="Medium" Foreground="{DynamicResource TextPrimary}"/>
                                    <TextBlock Margin="0,4,0,0" FontSize="12" Foreground="{DynamicResource TextSecondary}">
                                        <Run Text="{Binding DoneTodaySeconds, Converter={StaticResource SecondsToDurationConverter}}"/>
                                        <Run Text=" Done Today"/>
                                    </TextBlock>
                                </StackPanel>
                                
                                <!-- Timer Panel -->
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="48,0,0,0">
                                    <!-- Timer Display -->
                                    <StackPanel Margin="0,0,24,0">
                                        <Button Content="{Binding TimerButtonText}" Background="Transparent" BorderThickness="0" 
                                                FontSize="14" FontWeight="Medium" Command="{Binding ToggleTimerCommand}" 
                                                Foreground="{DynamicResource TextPrimary}" HorizontalAlignment="Right"
                                                FocusVisualStyle="{x:Null}" Cursor="Hand"/>
                                        <TextBlock Text="{Binding TimerRemaining, Converter={StaticResource SecondsToTimerDisplayConverter}}" 
                                                   FontSize="32" FontWeight="SemiBold" Foreground="{DynamicResource AccentStrong}" 
                                                   HorizontalAlignment="Right" Margin="0,8,0,0"/>
                                    </StackPanel>
                                    
                                    <!-- Timer Controls -->
                                    <StackPanel Orientation="Horizontal">
                                        <Button Width="55" Height="55" Command="{Binding ToggleTimerCommand}" 
                                                Background="{DynamicResource ButtonGradient}" Margin="0,0,8,0"
                                                FocusVisualStyle="{x:Null}" Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button" BasedOn="{StaticResource TimerCircleStyle}">
                                                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                                    <Setter Property="Content">
                                                        <Setter.Value>
                                                            <Viewbox Width="24" Height="24">
                                                                <Canvas Width="24" Height="24">
                                                                    <Path Data="M8 5v14l11-7z" Fill="White"/>
                                                                </Canvas>
                                                            </Viewbox>
                                                        </Setter.Value>
                                                    </Setter>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding TimerRunning}" Value="True">
                                                            <Setter Property="Content">
                                                                <Setter.Value>
                                                                    <Viewbox Width="24" Height="24">
                                                                        <Canvas Width="24" Height="24">
                                                                            <Path Data="M6 4h4v16H6V4zm8 0h4v16h-4V4z" Fill="White"/>
                                                                        </Canvas>
                                                                    </Viewbox>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                        <Button Width="55" Height="55" Command="{Binding ResetTimerCommand}" 
                                                Background="{DynamicResource ButtonGradient}" Style="{StaticResource TimerCircleStyle}"
                                                FocusVisualStyle="{x:Null}" Cursor="Hand">
                                            <Viewbox Width="24" Height="24">
                                                <Canvas Width="24" Height="24">
                                                    <Path Data="M21 10c0-4.4-3.6-8-8-8-3.5 0-6.5 2.3-7.6 5.5M3 4v4h4M3 14c0 4.4 3.6 8 8 8 3.5 0 6.5-2.3 7.6-5.5M21 20v-4h-4" 
                                                          Stroke="White" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Button>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                        
                        <!-- Calendar Card - 32px padding -->
                        <Border Background="{DynamicResource Surface}" BorderBrush="{DynamicResource Border}" 
                                BorderThickness="1" CornerRadius="16" Padding="32">
                            <Border.Effect>
                                <DropShadowEffect Color="Black" BlurRadius="20" ShadowDepth="4" Opacity="0.08"/>
                            </Border.Effect>
                            
                            <!-- Calendar Layout: 240px left + 50px gap + right -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="240"/>
                                    <ColumnDefinition Width="50"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Calendar Panel (240px) -->
                                <StackPanel Grid.Column="0">
                                    <!-- Calendar Header with nav -->
                                    <Grid Margin="0,0,0,28">
                                        <TextBlock Text="{Binding CurrentMonthDisplay}" FontSize="16" FontWeight="SemiBold" 
                                                   Foreground="{DynamicResource TextPrimary}"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                            <Button Width="26" Height="26" Command="{Binding PreviousMonthCommand}" 
                                                    Background="{DynamicResource Surface}" 
                                                    BorderBrush="{DynamicResource Border}" 
                                                    BorderThickness="1" 
                                                    Cursor="Hand" 
                                                    Margin="0,0,8,0"
                                                    FocusVisualStyle="{x:Null}">
                                                <Button.Template>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" 
                                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                                BorderThickness="{TemplateBinding BorderThickness}" 
                                                                CornerRadius="13">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Button.Template>
                                                <Viewbox Width="12" Height="12">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Data="M15 18l-6-6 6-6" Stroke="{DynamicResource IconStroke}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                            <Button Width="26" Height="26" Command="{Binding NextMonthCommand}" 
                                                    Background="{DynamicResource Surface}" 
                                                    BorderBrush="{DynamicResource Border}" 
                                                    BorderThickness="1" 
                                                    Cursor="Hand"
                                                    FocusVisualStyle="{x:Null}">
                                                <Button.Template>
                                                    <ControlTemplate TargetType="Button">
                                                        <Border Background="{TemplateBinding Background}" 
                                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                                BorderThickness="{TemplateBinding BorderThickness}" 
                                                                CornerRadius="13">
                                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Button.Template>
                                                <Viewbox Width="12" Height="12">
                                                    <Canvas Width="24" Height="24">
                                                        <Path Data="M9 18l6-6-6-6" Stroke="{DynamicResource IconStroke}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                    </Canvas>
                                                </Viewbox>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <!-- Calendar Grid -->
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <!-- Week Headers -->
                                        <UniformGrid Grid.Row="0" Rows="1" Columns="7" Margin="0,0,0,16">
                                            <TextBlock Text="Su" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="Mo" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="Tu" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="We" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="Th" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="Fr" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                            <TextBlock Text="Sa" FontSize="12" Foreground="{DynamicResource TextSecondary}" TextAlignment="Center"/>
                                        </UniformGrid>
                                        
                                        <!-- Calendar Days -->
                                        <ItemsControl Grid.Row="1" ItemsSource="{Binding CalendarDays}">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <UniformGrid Columns="7"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Grid Width="28" Height="28" Margin="2">
                                                        <Button Command="{Binding DataContext.SelectDateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                                CommandParameter="{Binding Date}"
                                                                Visibility="{Binding IsPlaceholder, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverse}"
                                                                Background="Transparent"
                                                                BorderThickness="0"
                                                                Cursor="Hand"
                                                                Width="28" Height="28"
                                                                FocusVisualStyle="{x:Null}">
                                                            <Button.Style>
                                                                <Style TargetType="Button">
                                                                    <Setter Property="Background" Value="Transparent"/>
                                                                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                                                    <Setter Property="Template">
                                                                        <Setter.Value>
                                                                            <ControlTemplate TargetType="Button">
                                                                                <Border x:Name="dayBorder" 
                                                                                        Background="{TemplateBinding Background}"
                                                                                        CornerRadius="14" 
                                                                                        Width="28" Height="28">
                                                                                    <TextBlock x:Name="dayNumber"
                                                                                               Text="{Binding Day}" 
                                                                                               Foreground="{DynamicResource TextPrimary}"
                                                                                               FontSize="12"
                                                                                               FontWeight="Normal"
                                                                                               HorizontalAlignment="Center" 
                                                                                               VerticalAlignment="Center"/>
                                                                                </Border>
                                                                                <ControlTemplate.Triggers>
                                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                                        <Setter TargetName="dayBorder" Property="Background" Value="{DynamicResource AccentSoft}"/>
                                                                                    </Trigger>
                                                                                    <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                                                        <Setter TargetName="dayBorder" Property="Background" Value="{DynamicResource Accent}"/>
                                                                                        <Setter TargetName="dayNumber" Property="Foreground" Value="White"/>
                                                                                        <Setter TargetName="dayNumber" Property="FontWeight" Value="SemiBold"/>
                                                                                    </DataTrigger>
                                                                                    <DataTrigger Binding="{Binding IsToday}" Value="True">
                                                                                        <Setter TargetName="dayNumber" Property="FontWeight" Value="SemiBold"/>
                                                                                    </DataTrigger>
                                                                                </ControlTemplate.Triggers>
                                                                            </ControlTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Button.Style>
                                                        </Button>
                                                    </Grid>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </Grid>
                                </StackPanel>
                                
                                <!-- Day Summary -->
                                <StackPanel Grid.Column="2">
                                    <TextBlock Text="{Binding SelectedDateDisplay}" FontSize="20" FontWeight="SemiBold" 
                                               Foreground="{DynamicResource TextPrimary}" Margin="0,0,0,4"/>
                                    <TextBlock FontSize="13" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,20">
                                        <Run Text="{Binding DailyTaskCount}"/>
                                        <Run Text=" Tasks planned"/>
                                    </TextBlock>
                                    
                                    <!-- Daily Task List (up to 3 items) -->
                                    <ItemsControl ItemsSource="{Binding DailyTasks}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="36"/>
                                                        <ColumnDefinition Width="12"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Border Grid.Column="0" Width="36" Height="36" Background="{DynamicResource Divider}" CornerRadius="12">
                                                        <TextBlock Text="{Binding DataContext.DailyTasks.Count, RelativeSource={RelativeSource AncestorType=ItemsControl}}" 
                                                                   FontWeight="SemiBold" Foreground="{DynamicResource TextSecondary}" 
                                                                   VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                                    </Border>
                                                    <TextBlock Grid.Column="2" Text="{Binding Name}" FontSize="14" 
                                                               Foreground="{DynamicResource TextPrimary}" VerticalAlignment="Center"/>
                                                </Grid>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                    
                                    <!-- Calendar Footer -->
                                    <StackPanel Margin="0,20,0,0">
                                        <TextBlock Text="{Binding ImportStatusMessage}" FontSize="12"
                                                   Foreground="{DynamicResource TextSecondary}" TextWrapping="Wrap"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                                            <Button Content="Import Next Month" Command="{Binding ImportNextMonthCommand}"
                                                    Style="{StaticResource PrimaryButtonStyle}" Height="40" MinWidth="180"
                                                    Cursor="Hand" FocusVisualStyle="{x:Null}"/>
                                            <TextBlock Margin="16,8,0,0" FontSize="12" Foreground="{DynamicResource TextSecondary}" VerticalAlignment="Center">
                                                <Run Text="Need a Google account? "/>
                                                <Hyperlink Command="{Binding CreateGoogleAccountCommand}" Foreground="{DynamicResource Accent}">
                                                    Create Google Account
                                                </Hyperlink>
                                            </TextBlock>
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Tasks Section -->
                <StackPanel>
                    <Grid Margin="0,0,0,24">
                        <StackPanel>
                            <TextBlock Text="Tasks List" FontSize="24" FontWeight="SemiBold" Foreground="{DynamicResource TextPrimary}"/>
                            <TextBlock Text="All Tasks" FontSize="14" Foreground="{DynamicResource TextSecondary}" Margin="0,6,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                                     Width="240" Height="44"
                                     Background="{DynamicResource Surface}" 
                                     Foreground="{DynamicResource TextPrimary}"
                                     BorderBrush="{DynamicResource Border}" 
                                     BorderThickness="1" Margin="0,0,12,0"
                                     FocusVisualStyle="{x:Null}">
                                <TextBox.Style>
                                    <Style TargetType="TextBox">
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="TextBox">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="22">
                                                        <Grid>
                                                            <Viewbox Width="18" Height="18" HorizontalAlignment="Left" Margin="14,0,0,0">
                                                                <Canvas Width="24" Height="24">
                                                                    <Path Data="M11 19a8 8 0 1 0 0-16 8 8 0 0 0 0 16zM21 21l-4.35-4.35" 
                                                                          Stroke="{DynamicResource TextMuted}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                                </Canvas>
                                                            </Viewbox>
                                                            <TextBlock x:Name="PlaceholderText" 
                                                                       Text="Search task" 
                                                                       Foreground="{DynamicResource TextMuted}" 
                                                                       FontSize="14"
                                                                       Margin="40,0,0,0"
                                                                       VerticalAlignment="Center"
                                                                       IsHitTestVisible="False"
                                                                       Visibility="Collapsed"/>
                                                            <ScrollViewer x:Name="PART_ContentHost" Margin="40,12,12,12" VerticalAlignment="Center" Focusable="False"/>
                                                        </Grid>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="Text" Value="">
                                                            <Setter TargetName="PlaceholderText" Property="Visibility" Value="Visible"/>
                                                        </Trigger>
                                                        <Trigger Property="Text" Value="{x:Null}">
                                                            <Setter TargetName="PlaceholderText" Property="Visibility" Value="Visible"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </TextBox.Style>
                            </TextBox>
                            <Button Width="44" Height="44" Margin="0,0,12,0" 
                                    Background="{DynamicResource Surface}" 
                                    BorderBrush="{DynamicResource Border}" 
                                    BorderThickness="1" 
                                    Cursor="Hand"
                                    FocusVisualStyle="{x:Null}">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                                BorderBrush="{TemplateBinding BorderBrush}" 
                                                BorderThickness="{TemplateBinding BorderThickness}" 
                                                CornerRadius="13">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Button.Template>
                                <Viewbox Width="20" Height="20">
                                    <Canvas Width="24" Height="24">
                                        <Path Data="M3 4h18M3 12h18M3 20h18" Stroke="{DynamicResource IconStroke}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
                                    </Canvas>
                                </Viewbox>
                            </Button>
                            <Button Command="{Binding AddTaskCommand}" Style="{StaticResource PrimaryButtonStyle}"
                                    FocusVisualStyle="{x:Null}" Cursor="Hand">
                                <StackPanel Orientation="Horizontal">
                                    <Viewbox Width="16" Height="16" Margin="0,0,8,0">
                                        <Canvas Width="24" Height="24">
                                            <Path Data="M12 5v14M5 12h14" Stroke="White" StrokeThickness="2.5" StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
                                        </Canvas>
                                    </Viewbox>
                                    <TextBlock Text="Add Task" VerticalAlignment="Center"/>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>

                    <!-- Tasks Table -->
                    <Border Background="{DynamicResource Surface}" BorderBrush="{DynamicResource Border}" 
                            BorderThickness="1" CornerRadius="16">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <DataGrid Grid.Row="0" ItemsSource="{Binding DisplayedTasks}" AutoGenerateColumns="False" 
                                      HeadersVisibility="Column" GridLinesVisibility="Horizontal" 
                                      BorderThickness="0" Background="Transparent" RowBackground="Transparent"
                                      AlternatingRowBackground="Transparent" CanUserAddRows="False" CanUserDeleteRows="False"
                                      IsReadOnly="True" SelectionMode="Single"
                                      Margin="20"
                                      FocusVisualStyle="{x:Null}">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Task name" Binding="{Binding Name}" Width="*" FontWeight="Medium" MinWidth="200"/>
                                    <DataGridTextColumn Header="Due date" Binding="{Binding DueDate, Converter={StaticResource DateFormatConverter}}" Width="120" MinWidth="100"/>
                                    <DataGridTextColumn Header="Due time" Binding="{Binding DueTime, Converter={StaticResource TimeFormatConverter}}" Width="100" MinWidth="80"/>
                                    <DataGridTemplateColumn Header="Reminders" Width="150">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Border Background="{Binding ReminderStatus, Converter={StaticResource ReminderStatusToBrushConverter}}" 
                                                        CornerRadius="12" Padding="14,8" HorizontalAlignment="Left">
                                                    <TextBlock Text="{Binding ReminderLabel}" FontSize="12" FontWeight="SemiBold" 
                                                               Foreground="{Binding ReminderStatus, Converter={StaticResource ReminderStatusToTextColorConverter}}" 
                                                               TextAlignment="Left"/>
                                                </Border>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTemplateColumn Width="120">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                                    <Button Width="36" Height="36" Margin="0,0,12,0" Background="Transparent" BorderThickness="0"
                                                            Command="{Binding DataContext.EditTaskCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}"
                                                            FocusVisualStyle="{x:Null}" Cursor="Hand">
                                                        <Viewbox Width="18" Height="18">
                                                            <Canvas Width="24" Height="24">
                                                                <Path Data="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" 
                                                                      Stroke="{DynamicResource Accent}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                            </Canvas>
                                                        </Viewbox>
                                                    </Button>
                                                    <Button Width="36" Height="36" Background="Transparent" BorderThickness="0"
                                                            Command="{Binding DataContext.DeleteTaskCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                                            CommandParameter="{Binding}"
                                                            FocusVisualStyle="{x:Null}" Cursor="Hand">
                                                        <Viewbox Width="18" Height="18">
                                                            <Canvas Width="24" Height="24">
                                                                <Path Data="M3 6h18M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" 
                                                                      Stroke="{DynamicResource Accent}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                            </Canvas>
                                                        </Viewbox>
                                                    </Button>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>

                            <!-- Pagination -->
                            <Border Grid.Row="1" Background="{DynamicResource Surface}" BorderBrush="{DynamicResource Divider}" 
                                    BorderThickness="0,1,0,0" Padding="24,16">
                                <Grid>
                                    <TextBlock Text="{Binding PaginationText}" FontSize="12" Foreground="{DynamicResource TextSecondary}" 
                                               FontWeight="Medium" VerticalAlignment="Center"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                        <TextBlock Text="Rows per page:" FontSize="12" Foreground="{DynamicResource TextSecondary}" 
                                                   VerticalAlignment="Center" Margin="0,0,12,0"/>
                                        <ComboBox SelectedValue="{Binding PageSize}" SelectedValuePath="Content" Width="60" Margin="0,0,12,0" FocusVisualStyle="{x:Null}" Validation.ErrorTemplate="{x:Null}">
                                            <ComboBox.Resources>
                                                <Style TargetType="ComboBoxItem">
                                                    <Setter Property="Background" Value="{StaticResource Surface}"/>
                                                    <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
                                                    <Setter Property="Padding" Value="8,6"/>
                                                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ComboBoxItem">
                                                                <Border x:Name="Bd" 
                                                                        Background="{TemplateBinding Background}"
                                                                        Padding="{TemplateBinding Padding}">
                                                                    <ContentPresenter/>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsHighlighted" Value="True">
                                                                        <Setter TargetName="Bd" Property="Background" Value="{StaticResource Divider}"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter TargetName="Bd" Property="Background" Value="Transparent"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ComboBox.Resources>
                                            <ComboBoxItem Content="10" IsSelected="True"/>
                                            <ComboBoxItem Content="25"/>
                                            <ComboBoxItem Content="50"/>
                                        </ComboBox>
                                        <Button Width="32" Height="32" Command="{Binding PreviousPageCommand}" Margin="0,0,8,0" 
                                                Background="{DynamicResource Surface}" 
                                                BorderBrush="{DynamicResource Border}" 
                                                BorderThickness="1" 
                                                Cursor="Hand"
                                                FocusVisualStyle="{x:Null}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            BorderBrush="{TemplateBinding BorderBrush}" 
                                                            BorderThickness="{TemplateBinding BorderThickness}" 
                                                            CornerRadius="13">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                            <Viewbox Width="14" Height="14">
                                                <Canvas Width="24" Height="24">
                                                    <Path Data="M15 18l-6-6 6-6" Stroke="{DynamicResource IconStroke}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Button>
                                        <Button Width="32" Height="32" Command="{Binding NextPageCommand}" 
                                                Background="{DynamicResource Surface}" 
                                                BorderBrush="{DynamicResource Border}" 
                                                BorderThickness="1" 
                                                Cursor="Hand"
                                                FocusVisualStyle="{x:Null}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            BorderBrush="{TemplateBinding BorderBrush}" 
                                                            BorderThickness="{TemplateBinding BorderThickness}" 
                                                            CornerRadius="13">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                            <Viewbox Width="14" Height="14">
                                                <Canvas Width="24" Height="24">
                                                    <Path Data="M9 18l6-6-6-6" Stroke="{DynamicResource IconStroke}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round" StrokeLineJoin="Round" Fill="Transparent"/>
                                                </Canvas>
                                            </Viewbox>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Border>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Floating Controls - Fixed left sidebar -->
        <Border Background="{DynamicResource Surface}" BorderBrush="{DynamicResource Border}" 
                BorderThickness="1" CornerRadius="20" Width="48" Height="96"
                VerticalAlignment="Top" HorizontalAlignment="Left" Margin="20,80,0,0" Panel.ZIndex="5">
            <Border.Effect>
                <DropShadowEffect Color="Black" BlurRadius="12" ShadowDepth="2" Opacity="0.1"/>
            </Border.Effect>
            <StackPanel VerticalAlignment="Center">
                <Button Width="48" Height="48" Command="{Binding ToggleThemeCommand}" 
                        Background="Transparent" BorderThickness="0" ToolTip="Toggle theme"
                        FocusVisualStyle="{x:Null}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="hoverBorder" Background="{TemplateBinding Background}" CornerRadius="24">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="hoverBorder" Property="Background" Value="{DynamicResource AccentSoft}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                    <Viewbox Width="20" Height="20">
                        <Canvas Width="24" Height="24">
                            <Path Data="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" 
                                  Fill="{DynamicResource TextPrimary}"/>
                        </Canvas>
                    </Viewbox>
                </Button>
                <Border Height="1" Background="{DynamicResource Border}" Margin="12,0"/>
                <Button Width="48" Height="47" Background="Transparent" BorderThickness="0"
                        Command="{Binding ImportNextMonthCommand}" ToolTip="Import next month from Google Calendar"
                        FocusVisualStyle="{x:Null}">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background" Value="Transparent"/>
                            <Setter Property="Cursor" Value="Hand"/>
                            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border x:Name="hoverBorder" Background="{TemplateBinding Background}" CornerRadius="24">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="hoverBorder" Property="Background" Value="{DynamicResource AccentSoft}"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                    <Viewbox Width="20" Height="20">
                        <Canvas Width="24" Height="24">
                            <Path Data="M12 2l2.4 7.4h7.6l-6 4.6 2.3 7-6.3-4.6-6.3 4.6 2.3-7-6-4.6h7.6z" 
                                  Fill="{DynamicResource TextPrimary}"/>
                        </Canvas>
                    </Viewbox>
                </Button>
            </StackPanel>
        </Border>

        <!-- Task Modal -->
        <Grid Grid.RowSpan="2" Background="#70000000" Visibility="{Binding IsModalOpen, Converter={StaticResource BoolToVisibilityConverter}}">
            <Border Background="{DynamicResource Surface}" Width="480" MaxHeight="460" CornerRadius="20" 
                    BorderBrush="{DynamicResource Border}" BorderThickness="1" Padding="32">
                <StackPanel>
                    <Grid Margin="0,0,0,24">
                        <TextBlock Text="{Binding ModalTitle}" FontSize="20" FontWeight="SemiBold" 
                                   Foreground="{DynamicResource TextPrimary}"/>
                        <Button Width="32" Height="32" HorizontalAlignment="Right" Background="Transparent" BorderThickness="0"
                                Command="{Binding CloseModalCommand}"
                                FocusVisualStyle="{x:Null}" Cursor="Hand">
                            <Viewbox Width="16" Height="16">
                                <Canvas Width="24" Height="24">
                                    <Path Data="M18 6L6 18M6 6l12 12" Stroke="{DynamicResource TextSecondary}" StrokeThickness="2" StrokeStartLineCap="Round" StrokeEndLineCap="Round"/>
                                </Canvas>
                            </Viewbox>
                        </Button>
                    </Grid>

                    <StackPanel>
                        <TextBlock Text="Task name" FontSize="13" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,8"/>
                        <TextBox Text="{Binding EditingTask.Name, UpdateSourceTrigger=PropertyChanged}" 
                                 Height="44" Margin="0,0,0,16"
                                 Background="{DynamicResource Surface}" 
                                 Foreground="{DynamicResource TextPrimary}"
                                 BorderBrush="{DynamicResource Border}" BorderThickness="1"
                                 FocusVisualStyle="{x:Null}">
                            <TextBox.Style>
                                <Style TargetType="TextBox">
                                    <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="TextBox">
                                                <Border Background="{TemplateBinding Background}" 
                                                        BorderBrush="{TemplateBinding BorderBrush}"
                                                        BorderThickness="{TemplateBinding BorderThickness}"
                                                        CornerRadius="12" Padding="14,10,14,10">
                                                    <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Focusable="False"/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </TextBox.Style>
                        </TextBox>

                        <Grid Margin="0,0,0,16">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="16"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Date" FontSize="13" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,8"/>
                                <DatePicker SelectedDate="{Binding EditingTask.DueDate}" Height="44" FocusVisualStyle="{x:Null}"/>
                            </StackPanel>

                            <StackPanel Grid.Column="2">
                                <TextBlock Text="Time" FontSize="13" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,8"/>
                                <TextBox Height="44" Text="09:00"
                                         Background="{DynamicResource Surface}" 
                                         Foreground="{DynamicResource TextPrimary}"
                                         BorderBrush="{DynamicResource Border}" BorderThickness="1"
                                         FocusVisualStyle="{x:Null}">
                                    <TextBox.Style>
                                        <Style TargetType="TextBox">
                                            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="TextBox">
                                                        <Border Background="{TemplateBinding Background}" 
                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                CornerRadius="12" Padding="14,10,14,10">
                                                            <ScrollViewer x:Name="PART_ContentHost" VerticalAlignment="Center" Focusable="False"/>
                                                        </Border>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </TextBox.Style>
                                </TextBox>
                            </StackPanel>
                        </Grid>

                        <TextBlock Text="Reminder status" FontSize="13" Foreground="{DynamicResource TextSecondary}" Margin="0,0,0,8"/>
                        <ComboBox SelectedValue="{Binding EditingTask.ReminderStatus}" 
                                  SelectedValuePath="Tag" 
                                  Height="44" Margin="0,0,0,16" FocusVisualStyle="{x:Null}">
                            <ComboBoxItem Content="Active" Tag="active"/>
                            <ComboBoxItem Content="Overdue" Tag="overdue"/>
                            <ComboBoxItem Content="Not set" Tag="none" IsSelected="True"/>
                        </ComboBox>

                        <Grid Margin="0,24,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="12"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Button Grid.Column="0" Content="Cancel" Command="{Binding CloseModalCommand}" 
                                    Height="44" Background="Transparent" 
                                    Foreground="{DynamicResource TextPrimary}"
                                    BorderBrush="{DynamicResource Border}" BorderThickness="1" Cursor="Hand"
                                    FocusVisualStyle="{x:Null}">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="12">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                            <Button Grid.Column="2" Content="Save Task" Command="{Binding SaveTaskCommand}" 
                                    Height="44" Background="{DynamicResource ButtonGradient}" 
                                    Foreground="White" FontWeight="SemiBold"
                                    BorderBrush="{DynamicResource Border}" BorderThickness="1" Cursor="Hand"
                                    FocusVisualStyle="{x:Null}">
                                <Button.Style>
                                    <Style TargetType="Button">
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}" 
                                                            BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            CornerRadius="12">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </Button.Style>
                            </Button>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        
    </Grid>
</Window>